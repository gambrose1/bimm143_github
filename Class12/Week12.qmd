---
title: "Class12: Asynchronous Project"
author: "Gavin Ambrose PID: A18548522"
format: pdf
toc: true
---

## Reading the genotype Data

We downloaded the data from the OMIM website genotype table.

```{r}
genotypeMXL <- read.csv("373531-SampleGenotypes-Homo_sapiens_Variation_Sample_rs8067378.csv")

```

> Q5: What proportion of the Mexican Ancestry in Los Angeles sample population (MXL) are homozygous for the asthma associated SNP (G|G)?

```{r}
table(genotypeMXL$Genotype..forward.strand.)
```

```{r}
round(table(genotypeMXL$Genotype..forward.strand.) / nrow(genotypeMXL) * 100, 2)
```

Let's compare that with the GBR population to see how these numbers relate.

```{r}
genotypeGBR <- read.csv("373522-SampleGenotypes-Homo_sapiens_Variation_Sample_rs8067378.csv")
round(table(genotypeGBR$Genotype..forward.strand.) / nrow(genotypeGBR) * 100, 2)
```

## Section 4: Population Scale Analysis(Homework Questions 13 and 14)

One sample is obviously not enough to know what is happening in a population. You are
interested in assessing genetic differences on a population scale. 

So, you processed about ~230 samples and did the normalization on a genome level. Now, you want to find whether there is any association of the 4 asthma-associated SNPs (rs8067378â€¦) on ORMDL3
expression.

> Q13: Read this file into R and determine the sample size for each genotype and their
corresponding median expression levels for each of these genotypes.

```{r}
expr <- read.table("Genotype_data_homework.txt")
head(expr)

nrow(expr)


table(expr$geno)

bp <- boxplot(exp ~ geno, data = expr)
round(bp$stats[3, ], 2)
```

The sample size for the A/A genotype is 108, the A/G is 233, and the G/G is 121. The median expression levels for the A/A genotype is 31.25, A/G is 25.06, and G/G is 20.07.

> Q14: Generate a boxplot with a box per genotype, what could you infer from the relative
expression value between A/A and G/G displayed in this plot? Does the SNP effect the
expression of ORMDL3?

```{r}
library(ggplot2)

ggplot(expr) + 
  aes(x = geno, y = exp, fill = geno) + 
  geom_boxplot(notch = T, outlier.shape = NA, alpha = 0.9) + 
  geom_jitter(aes(fill = geno),
  shape = 21, 
  color = "black",
  stroke = 0.8,      
  width = 0.15,
  size = 2.5,
  alpha = 0.4) +
  theme_minimal() +
  labs( x = "Genotype", y = "Expression Levels", title ="Genotype Dependent Expression Levels") +
  theme( legend.position = "none",  plot.title = element_text(size = 16, face = "bold"))
```

The boxplot shows that ORMDL3 expression is highest in the A/A genotype and lowest in the G/G genotype, with the A/G genotype showing intermediate expression. This pattern suggests that the SNP is associated with differences in ORMDL3 expression and likely has an additive effect on gene expression.



